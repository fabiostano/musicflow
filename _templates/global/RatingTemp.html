{{ extends 'global/Page.html' }}

{{ block script }}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        logStart();

        var player = document.getElementById('songPlayer');

        player.play();

        startProgressBar(25);

        // Stop playback after 30 seconds
        setTimeout(() => {
            player.pause();

            document.getElementById("progressBarContainer").style.display = "none";
            document.getElementById("addToPlaylist").style.display = "none";
            document.getElementById("likertContainer").style.display = "block";
            document.getElementById("nextbtn").style.display = "block";
        }, 25000); // 30000 milliseconds = 30 seconds
    });

    function add_to_playlist() {
        logPlaylist();

        document.getElementById('addedToPlaylistField').value = "True";

        document.getElementById('addToPlaylist').src = "{% static 'add_btn_activated.png' %}";
    }

    // Function to check if any preference is selected
    function updateNextButton() {
        var preferenceSelected = Array.from(document.querySelectorAll('input[name="preference"]')).some(radio => radio.checked);
        document.getElementById('nextbtn').disabled = !preferenceSelected;
    }

    // Add event listeners to preference radio buttons
    document.querySelectorAll('input[name="preference"]').forEach(radio => {
        radio.addEventListener('change', updateNextButton);
    });

    function startProgressBar(duration) {
        var elem = document.getElementById("progressBar");
        var width = 0;
        var totalTime = duration * 1000; // Total time in milliseconds
        var intervalTime = 100; // Update interval in milliseconds
        var increments = totalTime / intervalTime; // Total number of increments
        var widthIncrement = 100 / increments; // Width increment per interval

        );
var id = setInterval(frame, intervalTime
        function frame() {
            if (width >= 100) {
                clearInterval(id);
            } else {
                width += widthIncrement;
                elem.style.width = width + '%';
            }
        }
    }

    document.querySelector('.likert-scale').addEventListener('change', function(e) {
        console.log('Selected rating:', e.target.value);
    });

    function logPlaylist(){
        let date = new Date();
        document.getElementById("add").value = date.getTime();
    }

    function logStart(){
        let date = new Date();
        document.getElementById("start").value = date.getTime();
    }

</script>

{{ endblock }}

{{ block style }}

<style>
    .table.mytable {
        width: 100%; /* Full width */
        table-layout: fixed; /* Enables uniform column sizing except for first column */
        border-collapse: collapse; /* Reduces space between borders */
    }

    .table.mytable th,
    .table.mytable td {
        border: 1px solid #ccc; /* Light grey border for readability */
        padding: 8px; /* Padding for content inside cells */
        text-align: center; /* Center-align text */
    }

    .table.mytable th:first-child,
    .table.mytable td:first-child {
        width: 35%; /* Wider first column */
        text-align: left; /* Align text to the left for the first column */
    }

    .table.mytable th {
        font-size: 12px; /* Decrease font size for headers */
    }

    .likert-scale label {
        display: block; /* Makes the label block level for better control */
        width: 100%; /* Full width */
        padding: 10px 0; /* Padding above and below the text */
        text-align: center; /* Centers the text horizontally */
        cursor: pointer; /* Changes the mouse cursor to pointer */
        background-color: #f8f8f8; /* Light grey background */
        border: 1px solid #e0e0e0; /* Slightly darker border */
        transition: background-color 0.3s; /* Smooth transition for background color */
    }

    .likert-scale input[type="radio"]:checked + label {
        background-color: #bdd4fb; /* Change background when selected */
    }

    .likert-scale input[type="radio"] {
        display: none; /* Hides the radio button */
    }

    #progressBarContainer {
        width: 100%;
        background-color: #ddd;
    }

    #progressBar {
        width: 0%;
        height: 30px;
        background-color: #4CAF50;
        transition: width 0.5s ease-in-out; /* Smooth transition for the width change */
    }

    .likert-container {
        width: 100%;
        margin: 20px 0;
    }

    .likert-scale {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        margin-top: 15px;
    }

    .likert-scale input[type="radio"] {
        display: none; /* Hide the radio button */
    }

    .likert-scale label {
        display: block;
        font-size: 25px;
        flex-grow: 1;
        text-align: center;
        background-color: lightblue;
        padding: 10px;
        border: 2px solid transparent;
        cursor: pointer;
        transition: background-color 0.2s, transform 0.2s;
    }

    .likert-scale label:hover,
    .likert-scale input[type="radio"]:checked + label {
        background-color: #e0e0e0;
        transform: translateY(-2px);
    }

    .likert-scale label:not(:first-of-type) {
        margin-left: 2px; /* Equal distance */
    }

    .likert-scale-table {
        width: 100%;
        table-layout: fixed; /* Ensures equal column width */
        border-collapse: collapse;
        text-align: center;
    }

    #maia tr:nth-child(even) {background-color: #f9f9f9;}
        th {
            text-align:center;
            min-width: 50px;
        }
        input[type="radio"]{margin-left:-5.5px}

    #maia2 tr:nth-child(even) {background-color: #f9f9f9;}
    th {
        text-align:center;
        min-width: 50px;
    }
    input[type="radio"]{margin-left:-5.5px}

</style>

{{ endblock }}